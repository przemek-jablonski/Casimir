name: Build for all  platforms
# https://stackoverflow.com/questions/60245159/how-can-i-build-a-swift-package-for-ios-over-command-line#62246008

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]
  schedule:
    - cron: 0 10 * * 2
  
jobs:
  build:
    runs-on: macos-latest
    steps:
    - name: Code checkout
      uses: actions/checkout@v2
    - name: xcodebuild version
      run: xcodebuild -version
    - name: Build  macOS (10.15)
      run: xcodebuild -scheme Casimir -destination 'platform=macOS,arch=x86_64,id=4203018E-580F-C1B5-9525-B745CECA79EB'
    - name: Build  macOS Catalyst (10.15)
      run: xcodebuild -scheme Casimir -destination 'platform=macOS,arch=x86_64,variant=Mac Catalyst,id=4203018E-580F-C1B5-9525-B745CECA79EB'
    - name: Build  iOS (14.4)
      run: xcodebuild -scheme Casimir -destination 'platform=iOS Simulator,OS=14.4,name=iPhone 12'
    - name: Build  tvOS (14.3)
      run: xcodebuild -scheme Casimir -destination 'platform=tvOS Simulator,OS=14.3,name=Apple TV 4K'
    - name: Build  watchOS (7.2)
      run: xcodebuild -scheme Casimir -destination 'platform=watchOS Simulator,OS=7.2,name=Apple Watch Series 6 - 44mm'
    - name: Switch to Xcode 12.0.1
      run: sudo xcode-select -switch /Applications/Xcode_12.app
    - name: Build  macOS (10.15)
      run: xcodebuild -scheme Casimir -destination 'platform=macOS,arch=x86_64,id=4203018E-580F-C1B5-9525-B745CECA79EB'
    - name: Build  macOS Catalyst (10.15)
      run: xcodebuild -scheme Casimir -destination 'platform=macOS,arch=x86_64,variant=Mac Catalyst,id=4203018E-580F-C1B5-9525-B745CECA79EB'
    - name: Build  iOS (14.0)
      run: xcodebuild -scheme Casimir -destination 'platform=iOS Simulator,OS=14.0,name=iPad Pro (12.9-inch) (4th generation)'
    - name: Build  tvOS (14.0)
      run: xcodebuild -scheme Casimir -destination 'platform=tvOS Simulator,OS=14.0,name=Apple TV'
    - name: Build  watchOS (7.0)
      run: xcodebuild -scheme Casimir -destination 'platform=watchOS Simulator,OS=7.0,name=Apple Watch Series 4 - 40mm'      
